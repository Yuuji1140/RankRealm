{% extends "base.html" %}

{% block title %}Events | Rank Realm{% endblock %}

{% block content %}
<h1>Events</h1>

{% if current_user.is_authenticated %}
    <h2>Create Event</h2>
    <form action="{{ url_for('views.create_event') }}" method="POST">
        <div class="form-group">
            <label for="game_id">Game:</label>
            <select class="form-control" id="game_id" name="game_id" required>
                {% for game in games %}
                    <option value="{{ game.id }}">{{ game.title }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="start_date">Start Date:</label>
            <input type="datetime-local" class="form-control" id="start_date" name="start_date" required>
        </div>
        <div class="form-group">
            <label for="end_date">End Date:</label>
            <input type="datetime-local" class="form-control" id="end_date" name="end_date" required>
        </div>
        <button type="submit" class="btn btn-primary">Create Event</button>
    </form>
{% endif %}

<h2>Upcoming Events</h2>
{% for event in events %}
    <div class="event">
        <h3>{{ event.game.title }}</h3>
        <p>Start Date: {{ event.start_date }}</p>
        <p>End Date: {{ event.end_date }}</p>
        <a href="{{ url_for('views.individual_event', event_id=event.id) }}" class="btn btn-primary">View Event</a>
        {% if current_user.is_authenticated and event.owner_id == current_user.id %}
            <form action="{{ url_for('views.delete_event', event_id=event.id) }}" method="POST" class="d-inline">
                <button type="submit" class="btn btn-danger">Delete Event</button>
            </form>
        {% endif %}
    </div>
{% endfor %}

{% endblock %}